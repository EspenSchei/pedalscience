---
import BaseLayout from "../../layouts/BaseLayout.astro";
import Button from "../../components/Button.astro";
import Card from "../../components/Card.astro";

const title = "Nutrition Calculator";
const description =
    "How many carbohydrates you should consume per hour based on intensity and duration.";
---

<BaseLayout {title} {description}>
    <header class="mb-6">
        <h1 class="text-2xl font-semibold tracking-tight text-slate-900 sm:text-3xl">
            Nutrition Calculator
        </h1>

        <p class="mt-2 max-w-2xl text-sm text-slate-600">
            Select intensity and duration. The calculator suggests how many carbs per hour
            work well for typical cycling sessions.
        </p>
    </header>

    <div class="mt-4 grid gap-6 md:grid-cols-2">
        <div class="space-y-4">
            <!-- Intensity -->
            <div class="space-y-1 text-sm">
                <label for="zone">Intensity</label>
                <select id="zone" class="w-full">
                    <option value="z2">Easy (Z2)</option>
                    <option value="z3">Tempo (Z3)</option>
                    <option value="z4">Threshold (Z4)</option>
                    <option value="z5">Hard (Z5/VO₂)</option>
                </select>
            </div>

            <!-- Duration -->
            <div class="space-y-1 text-sm">
                <label for="hours">Duration (hours)</label>
                <input id="hours" type="number" step="0.1" value="3" class="w-full" />
                <p class="form-help">
                    Round to the nearest half hour if unsure – it's better to have a bit
                    too much than too little.
                </p>
            </div>

            <div class="form-actions">
                <Button id="calcBtn" variant="primary">
                    Calculate needs
                </Button>
            </div>
        </div>

        <Card title="Result">
            <div id="result" class="text-sm text-slate-600">
                Fill in data and click "Calculate".
            </div>
        </Card>
    </div>

    <script type="module">
        const result = document.getElementById("result");

        const intakePerZone = {
            z2: [30, 45],
            z3: [45, 60],
            z4: [60, 75],
            z5: [90, 110],
        };

        function calc() {
            const zone = document.getElementById("zone").value;
            const hours = Number(document.getElementById("hours").value) || 0;

            const [minG, maxG] = intakePerZone[zone];
            const totalMin = minG * hours;
            const totalMax = maxG * hours;

            result.innerHTML = `
        <p class="font-semibold text-slate-800">Recommended carb intake:</p>
        <p class="text-slate-900">${minG}–${maxG} g per hour</p>
        <p class="mt-3 font-semibold text-slate-800">Total amount:</p>
        <p class="text-slate-900">${totalMin}–${totalMax} g</p>
      `;
        }

        document.getElementById("calcBtn").onclick = calc;
    </script>
</BaseLayout>
